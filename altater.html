<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="Exodus Altater Cup Leaderboard">
    <meta property="og:description" content="How do you stack up to other potatoes?">
    <meta property="og:url" content="https://neokat.github.io/altater">
    <meta http-equiv='cache-control' content='no-cache'>
    <meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
    <title>Exodus Altater Cup Leaderboard</title>

    <link rel="icon" href="https://imagizer.imageshack.com/img922/9420/eRxVah.png" type="image/x-icon">

    <style>
        html, body {
            overflow: hidden;
            margin: 0;
            padding: 0;
            height: 100%;
        }

        body {
            background-image: url("https://imagizer.imageshack.com/img923/3796/vK5CCI.png");
            background-repeat: repeat;
        }

        #header {
            width: 100%;
            text-align: center;
            align-items: center;
            box-sizing: border-box;
            position: fixed;
            top: 0;
            z-index: 1000;
            transition: height 0.3s, padding 0.3s;
        }

        #header img {
            width: 60%; /* Adjust the size as needed */
            height: auto;
        }

        #content {
            width: 100%;
            box-sizing: border-box;
            overflow-y: auto;
            position: relative; /* Added positioning context */
            max-height: calc(100vh - 70px); /* Adjust based on the header height */
        }

        #spuds {
            font-family: Verdana, Helvetica, sans-serif;
            border-collapse: collapse;
            width: 85%;
            margin: auto;
        }

        #spuds td, #spuds th {
            border: 2px solid #4f4f4f;
            padding: 4px;
            text-align: right !important;
        }

        #spuds tr:nth-child(even) {
            background-color: #f2f2f2;
        }

        #spuds tr:nth-child(odd) {
            background-color: #d9d9d9;
        }

        #spuds th {
            padding-top: 12px;
            padding-bottom: 12px;
            text-align: left;
            background-color: #EBC84D;
            color: #000000;
        }

        @media only screen and (max-width: 730px) {
            #spuds td:nth-child(3),
            #spuds th:nth-child(3),
            #spuds td:nth-child(4),
            #spuds th:nth-child(4),
            #spuds td:nth-child(5),
            #spuds th:nth-child(5),
            #spuds td:nth-child(6),
            #spuds th:nth-child(6),
            #spuds td:nth-child(9),
            #spuds th:nth-child(9) {
                display: none;
            }

            .yellow-box {
                font-size: 10px;
            }

            #header img {
                width: 80%; /* Adjust the size as needed */
                height: auto;
            }
        }

        .yellow-box {
            background-color: #EBC84D;
            padding: 4px;
            font-family: Verdana, Helvetica, sans-serif;
            width: 85%;
            margin: auto;
            box-sizing: border-box;
            text-align: center;
        }
    </style>
</head>
<body>
<div id="header">
    <img src="https://imagizer.imageshack.com/img924/9630/m2LMWs.png" alt="Exodus Altater Cup Banner">
</div>

<div id="content">
    <div class="yellow-box">
        <b>NOTE: This scoreboard is updated semi-automatically!</b> Every time we visit your stats page, the data is
        scraped and populates on the scoreboard. The "last updated" column tells when the data was last pulled for each
        person. If you aren't seeing up-to-date stats, first try to do a hard refresh <b>(cmd+shift+R</b> on
        mac or <b>ctrl+shift+R</b> on windows) to make your browser pull fresh data. If it's still out-of-date, bug
        Kat or Samara to refresh it :P
    </div>
    <br><br>
    <table id="spuds">
        <thead>
        <tr>
            <th>TEAM</th>
            <th>USERNAME</th>
            <th>YYB WINS</th>
            <th>SLSL PLAYS</th>
            <th>MSN PLAYS</th>
            <th>SOSD PLAYS</th>
            <th>TOTAL POINTS</th>
            <th>RANK</th>
            <th>LAST UPDATED (NST)</th>
        </tr>
        </thead>
        <tbody>
        <!-- Data will be populated here -->
        </tbody>
    </table>
    <br><br><br><br>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {

        // Initial setting of the margin-top for #content
        let headerImg = document.querySelector('#header img');
        let contentBox = document.querySelector('#content');

        function adjustContentTop() {
            let headerHeight = headerImg.getBoundingClientRect().height;
            contentBox.style.top = headerHeight + 'px';
            contentBox.style.maxHeight = `calc(100vh - ${headerHeight}px)`;
        }

        function adjustLayout() {
            // Ensure that contentBox's top and maxHeight are adjusted after rendering
            requestAnimationFrame(adjustContentTop);
        }

        // Initial adjustment of the content position
        adjustLayout();

        // Adjust the margin dynamically based on header image size
        window.addEventListener('resize', adjustContentTop);


        fetch('altater_scores.json')
            .then(response => response.json())
            .then(scores => {
                scores.sort((a, b) => b.total_score - a.total_score);

                const scoresTableBody = document.getElementById('spuds').getElementsByTagName('tbody')[0];

                scores.forEach(score => {
                    const row = scoresTableBody.insertRow();

                    const cellTeamLogo = row.insertCell();
                    const img = document.createElement('img');
                    img.src = score.team_logo;
                    img.height = 40;
                    img.alt = score.team_name;
                    cellTeamLogo.style.setProperty("text-align", "center", "important");
                    cellTeamLogo.appendChild(img);

                    const cellUsername = row.insertCell();
                    const link = document.createElement('a');
                    link.href = 'https://www.neopets.com/altador/colosseum/userstats.phtml?username=' + score.username;
                    link.textContent = score.username;
                    link.target = '_blank';
                    cellUsername.appendChild(link);

                    const cellYybWins = row.insertCell();
                    cellYybWins.textContent = score.yyb_wins;

                    const cellSlslGames = row.insertCell();
                    cellSlslGames.textContent = score.slsl_wins;

                    const cellMsnPlays = row.insertCell();
                    cellMsnPlays.textContent = score.msn_plays;

                    const cellSosdPlays = row.insertCell();
                    cellSosdPlays.textContent = score.sosd_plays;

                    const cellTotalScore = row.insertCell();
                    cellTotalScore.textContent = score.total_score;

                    const cellRank = row.insertCell();
                    cellRank.textContent = score.rank;

                    const cellLastUpdated = row.insertCell();
                    cellLastUpdated.textContent = score.last_updated;
                });
            })
            .catch(error => {
                console.error('Error fetching the JSON data:', error);
            });

        function adjustHeaderOnScroll() {
            // Calculate the scroll percentage
            let scrollTop = contentBox.scrollTop;
            let maxScrollTop = contentBox.scrollHeight - contentBox.clientHeight;
            let scrollPercentage = scrollTop / maxScrollTop;

            // Adjust the header image width based on scroll percentage
            let newWidth = Math.max(30, 60 - scrollPercentage * 30); // Example range from 60% to 30%
            headerImg.style.width = newWidth + '%';
        }

        // Add scroll event listener to contentBox
        contentBox.addEventListener('scroll', function () {
            adjustHeaderOnScroll();
            adjustContentTop();
        });
    });

</script>
</body>
</html>
